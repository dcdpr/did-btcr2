<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Security Considerations - did:btcr2 DID Method Specification</title>


        <!-- Custom HTML head -->
        <meta name="darkreader-lock"/>

        <meta name="description" content="did:btcr2 is a censorship-resistant Decentralized Identifier (DID) method using the Bitcoin blockchain as a Verifiable Data Registry to announce changes to the DID document.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/assets/tabs.css">
        <link rel="stylesheet" href="../theme/custom.css">
        <link rel="stylesheet" href="../theme/pagetoc.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">did:btcr2 DID Method Specification</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dcdpr/did-btcr2" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h1>
<h2 id="late-publishing"><a class="header" href="#late-publishing">Late Publishing</a></h2>
<p><strong>did:btcr2</strong> was designed to avoid <a href="../terminology.html#late-publishing">Late Publishing</a> such that, independent of when a resolution occurs, the DID document history and provenance are guaranteed to be invariant. Resolvers MUST enforce strict ordering of the <a href="../terminology.html#btcr2-update">BTCR2 Updates</a> and process all relevant <a href="../terminology.html#beacon-signal">Beacon Signals</a>.</p>
<h2 id="invalidation-attacks"><a class="header" href="#invalidation-attacks">Invalidation Attacks</a></h2>
<p>Invalidation attacks are where adversaries are able to publish <a href="../terminology.html#beacon-signal">Beacon Signals</a> that claim to contain updates for DIDs they do not control. Due to the requirement for processing all relevant <a href="../terminology.html#beacon-signal">Beacon Signals</a>, if these updates cannot be retrieved by a resolver, the DID MUST be considered invalid. To prevent these attacks, all <a href="../terminology.html#beacon-signal">Beacon Signals</a> SHOULD be authorized by signatures: either from the DID controller when using a <a href="../terminology.html#singleton-beacon">Singleton Beacon</a> or with a <code>n-of-n</code> multisignature from all <code>n</code> members of an <a href="../terminology.html#aggregation-cohort">Aggregation Cohort</a> when using an <a href="../terminology.html#aggregate-beacon">Aggregate Beacon</a>. DID controllers SHOULD verify the updates announced within a <a href="../terminology.html#beacon-signal">Beacon Signal</a> before authorizing it.</p>
<h2 id="deployment-considerations"><a class="header" href="#deployment-considerations">Deployment Considerations</a></h2>
<h3 id="data-retention"><a class="header" href="#data-retention">Data Retention</a></h3>
<p><a href="../terminology.html#btcr2-update">BTCR2 Updates</a> MUST be available to resolver at the time of resolution. It is the responsibility of DID controllers to persist this data, otherwise the consequence is that the DID MAY not be resolvable (depending on data accessibility from the perspective of the resolver). DID controllers MAY store <a href="../terminology.html#btcr2-update">BTCR2 Updates</a> on a <a href="../terminology.html#cas">CAS</a> system. DID controllers SHOULD consider that in some constrained environments it is preferable to discard a DID and replace it with a newly issued DID, rather than rotating a key.</p>
<h3 id="aggregate-beacon-address-verification"><a class="header" href="#aggregate-beacon-address-verification">Aggregate Beacon Address Verification</a></h3>
<p>A <a href="../terminology.html#beacon-address">Beacon Address</a> of an <a href="../terminology.html#aggregate-beacon">Aggregate Beacon</a> SHOULD be an <code>n-of-n</code> Pay-to-Taproot (P2TR) address, with a key contributed to the <code>n</code> by each of the participants in an <a href="../terminology.html#aggregation-cohort">Aggregation Cohort</a>. DID controllers participating in an <a href="../terminology.html#aggregation-cohort">Aggregation Cohort</a> SHOULD verify the <a href="../terminology.html#beacon-address">Beacon Address</a> is an <code>n-of-n</code> and that one of the <code>n</code> keys is the key that they provided to the <a href="../terminology.html#aggregation-service">Aggregation Service</a>. This can be achieved only by constructing the <a href="../terminology.html#beacon-address">Beacon Address</a> for themselves using the set of keys from the <a href="../terminology.html#aggregation-cohort">Aggregation Cohort</a> that SHOULD be provided by the <a href="../terminology.html#aggregation-service">Aggregation Service</a>.</p>
<h3 id="aggregate-beacon-signal-verification"><a class="header" href="#aggregate-beacon-signal-verification">Aggregate Beacon Signal Verification</a></h3>
<p>When submitting <a href="../terminology.html#beacon-signal">Beacon Signals</a> to <a href="../terminology.html#aggregation-service">Aggregation Services</a>, a DID controller will either: announce an <a href="../terminology.html#btcr2-update">BTCR2 Update</a> for their DID or not. The DID controller SHOULD verify that the <a href="../terminology.html#beacon-signal">Beacon Signal</a> announces the <a href="../terminology.html#btcr2-update">BTCR2 Update</a> they expect (or no <a href="../terminology.html#btcr2-update">BTCR2 Update</a>) for all <a href="../terminology.html#beacon-signal">Beacon Signals</a> broadcast by <a href="../terminology.html#aggregation-service">Aggregation Services</a> before final authorization. If they do not, then invalidation attacks become possible where a <a href="../terminology.html#beacon-signal">Beacon Signal</a> announces a <a href="../terminology.html#btcr2-update">BTCR2 Update</a> that cannot be retrieved for a particular DID, causing the DID to be invalidated.</p>
<h3 id="key-compromise"><a class="header" href="#key-compromise">Key Compromise</a></h3>
<p>In <strong>did:btcr2</strong>, cryptographic keys authorize both <a href="../terminology.html#btcr2-update">BTCR2 Updates</a> and <a href="../terminology.html#beacon-signal">Beacon Signals</a>. Should these keys get compromised without the DID controller’s knowledge, it would be possible for an adversary to take control of a DID by submitting a <a href="../terminology.html#btcr2-update">BTCR2 Update</a> to a <a href="../terminology.html#btcr2-beacon">BTCR2 Beacon</a> that replaces key material and <a href="../terminology.html#btcr2-beacon">BTCR2 Beacons</a> in the DID document for ones under the adversary’s control. Such an attack would be detectable by the DID controller, as they would see a valid spend from a <a href="../terminology.html#btcr2-beacon">BTCR2 Beacon</a> that they did not authorize. Additionally, if the DID relied on <a href="../terminology.html#sidecar-data">Sidecar Data</a>, without access to this data the DID would be useless to the adversary as they would be unable to demonstrate a valid complete history of the DID during resolution.</p>
<h3 id="cryptographic-compromise"><a class="header" href="#cryptographic-compromise">Cryptographic Compromise</a></h3>
<p>The security of <strong>did:btcr2</strong> identifiers depends on the security of <a href="../terminology.html#schnorr-signature">Schnorr Signatures</a> over the secp256k1 curve. It is this signature scheme that is used to secure both the <a href="../terminology.html#beacon-signal">Beacon Signals</a> and <a href="../terminology.html#btcr2-update">BTCR2 Updates</a>. Should vulnerabilities be discovered in this scheme or if advancements in quantum computing compromise its cryptographic foundations, the <strong>did:btcr2</strong> method would become obsolete.</p>
<h3 id="bitcoin-blockchain-compromise"><a class="header" href="#bitcoin-blockchain-compromise">Bitcoin Blockchain Compromise</a></h3>
<p>The security of <strong>did:btcr2</strong> identifiers depends on the security of the Bitcoin blockchain. Should the Bitcoin blockchain become compromised such that its history could be rewritten, for example through a 51% attack, then <a href="../terminology.html#beacon-signal">Beacon Signals</a> that were once part of the blockchain could be removed or replaced – although the longer these <a href="../terminology.html#beacon-signal">Beacon Signals</a> have been included in the blockchain the more difficult this becomes. A 51% attack could prevent future <a href="../terminology.html#beacon-signal">Beacon Signals</a> from being included within the network, however this would require the 51% attack to remain indefinitely enforced. Furthermore, without key compromise related to a specific DID, the compromise of the Bitcoin blockchain would not enable adversarial parties to take control of a DID.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../appendix/privacy-considerations.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../appendix/optimized-smt.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../appendix/privacy-considerations.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../appendix/optimized-smt.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../src/assets/mermaid.min.js"></script>
        <script src="../src/assets/mermaid-init.js"></script>
        <script src="../src/assets/tabs.js"></script>
        <script src="../theme/pagetoc.js"></script>



    </div>
    </body>
</html>
